"use strict";function cov_1a4jjtb9ai(){var path="/home/rafael/Documentos/Projects/Personal/classes/typescript/web-service/dist/server/auth.js";var hash="478b58a356c6e7cc217718190942ad007015c72e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/rafael/Documentos/Projects/Personal/classes/typescript/web-service/dist/server/auth.js",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:15},end:{line:3,column:34}},"2":{start:{line:4,column:21},end:{line:4,column:44}},"3":{start:{line:5,column:16},end:{line:5,column:49}},"4":{start:{line:6,column:13},end:{line:6,column:45}},"5":{start:{line:8,column:22},end:{line:8,column:45}},"6":{start:{line:9,column:15},end:{line:12,column:5}},"7":{start:{line:13,column:4},end:{line:28,column:8}},"8":{start:{line:14,column:8},end:{line:27,column:11}},"9":{start:{line:16,column:12},end:{line:21,column:13}},"10":{start:{line:17,column:16},end:{line:20,column:19}},"11":{start:{line:22,column:12},end:{line:22,column:37}},"12":{start:{line:25,column:12},end:{line:25,column:56}},"13":{start:{line:26,column:12},end:{line:26,column:28}},"14":{start:{line:29,column:4},end:{line:32,column:6}},"15":{start:{line:30,column:34},end:{line:30,column:63}},"16":{start:{line:31,column:36},end:{line:31,column:92}},"17":{start:{line:34,column:0},end:{line:34,column:29}}},fnMap:{"0":{name:"authConfig",decl:{start:{line:7,column:9},end:{line:7,column:19}},loc:{start:{line:7,column:22},end:{line:33,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:51},end:{line:13,column:52}},loc:{start:{line:13,column:79},end:{line:28,column:5}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:15,column:18},end:{line:15,column:19}},loc:{start:{line:15,column:34},end:{line:23,column:9}},line:15},"3":{name:"(anonymous_3)",decl:{start:{line:24,column:19},end:{line:24,column:20}},loc:{start:{line:24,column:34},end:{line:27,column:9}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:30,column:20},end:{line:30,column:21}},loc:{start:{line:30,column:32},end:{line:30,column:65}},line:30},"5":{name:"(anonymous_5)",decl:{start:{line:31,column:22},end:{line:31,column:23}},loc:{start:{line:31,column:34},end:{line:31,column:94}},line:31}},branchMap:{"0":{loc:{start:{line:16,column:12},end:{line:21,column:13}},type:"if",locations:[{start:{line:16,column:12},end:{line:21,column:13}},{start:{line:16,column:12},end:{line:21,column:13}}],line:16}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"478b58a356c6e7cc217718190942ad007015c72e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1a4jjtb9ai=function(){return actualCoverage;};}return actualCoverage;}cov_1a4jjtb9ai();cov_1a4jjtb9ai().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var passport=(cov_1a4jjtb9ai().s[1]++,require("passport"));var passport_jwt_1=(cov_1a4jjtb9ai().s[2]++,require("passport-jwt"));var service_1=(cov_1a4jjtb9ai().s[3]++,require("./modules/user/service"));var config=(cov_1a4jjtb9ai().s[4]++,require("./config/env/config")());function authConfig(){cov_1a4jjtb9ai().f[0]++;var UserService=(cov_1a4jjtb9ai().s[5]++,new service_1.default());var opts=(cov_1a4jjtb9ai().s[6]++,{secretOrKey:config.secret,jwtFromRequest:passport_jwt_1.ExtractJwt.fromAuthHeaderAsBearerToken()});cov_1a4jjtb9ai().s[7]++;passport.use(new passport_jwt_1.Strategy(opts,function(jwtPayload,done){cov_1a4jjtb9ai().f[1]++;cov_1a4jjtb9ai().s[8]++;UserService.getUserById(jwtPayload.id).then(function(user){cov_1a4jjtb9ai().f[2]++;cov_1a4jjtb9ai().s[9]++;if(user){cov_1a4jjtb9ai().b[0][0]++;cov_1a4jjtb9ai().s[10]++;return done(null,{id:user.id,email:user.email});}else{cov_1a4jjtb9ai().b[0][1]++;}cov_1a4jjtb9ai().s[11]++;return done(null,false);}).catch(function(err){cov_1a4jjtb9ai().f[3]++;cov_1a4jjtb9ai().s[12]++;console.log("Authentication Error: "+err);cov_1a4jjtb9ai().s[13]++;done(err,null);});}));cov_1a4jjtb9ai().s[14]++;return{initialize:function(){cov_1a4jjtb9ai().f[4]++;cov_1a4jjtb9ai().s[15]++;return passport.initialize();},authenticate:function(){cov_1a4jjtb9ai().f[5]++;cov_1a4jjtb9ai().s[16]++;return passport.authenticate("jwt",{session:false});}};}cov_1a4jjtb9ai().s[17]++;exports.default=authConfig;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJwYXNzcG9ydCIsInJlcXVpcmUiLCJwYXNzcG9ydF9qd3RfMSIsInNlcnZpY2VfMSIsImNvbmZpZyIsImF1dGhDb25maWciLCJVc2VyU2VydmljZSIsImRlZmF1bHQiLCJvcHRzIiwic2VjcmV0T3JLZXkiLCJzZWNyZXQiLCJqd3RGcm9tUmVxdWVzdCIsIkV4dHJhY3RKd3QiLCJmcm9tQXV0aEhlYWRlckFzQmVhcmVyVG9rZW4iLCJ1c2UiLCJTdHJhdGVneSIsImp3dFBheWxvYWQiLCJkb25lIiwiZ2V0VXNlckJ5SWQiLCJpZCIsInRoZW4iLCJ1c2VyIiwiZW1haWwiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJpbml0aWFsaXplIiwiYXV0aGVudGljYXRlIiwic2Vzc2lvbiJdLCJtYXBwaW5ncyI6IkFBQUEsYSx1MUZBZVk7bUhBZFpBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsQ0FBK0IsWUFBL0IsQ0FBNkMsQ0FBRUMsS0FBSyxDQUFFLElBQVQsQ0FBN0MsRUFDQSxHQUFJQyxDQUFBQSxRQUFRLDBCQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFWLENBQVosQ0FDQSxHQUFJQyxDQUFBQSxjQUFjLDBCQUFHRCxPQUFPLENBQUMsY0FBRCxDQUFWLENBQWxCLENBQ0EsR0FBSUUsQ0FBQUEsU0FBUywwQkFBR0YsT0FBTyxDQUFDLHdCQUFELENBQVYsQ0FBYixDQUNBLEdBQUlHLENBQUFBLE1BQU0sMEJBQUdILE9BQU8sQ0FBQyxxQkFBRCxDQUFQLEVBQUgsQ0FBVixDQUNBLFFBQVNJLENBQUFBLFVBQVQsRUFBc0IseUJBQ2xCLEdBQUlDLENBQUFBLFdBQVcsMEJBQUcsR0FBSUgsQ0FBQUEsU0FBUyxDQUFDSSxPQUFkLEVBQUgsQ0FBZixDQUNBLEdBQUlDLENBQUFBLElBQUksMEJBQUcsQ0FDUEMsV0FBVyxDQUFFTCxNQUFNLENBQUNNLE1BRGIsQ0FFUEMsY0FBYyxDQUFFVCxjQUFjLENBQUNVLFVBQWYsQ0FBMEJDLDJCQUExQixFQUZULENBQUgsQ0FBUixDQUZrQix3QkFNbEJiLFFBQVEsQ0FBQ2MsR0FBVCxDQUFhLEdBQUlaLENBQUFBLGNBQWMsQ0FBQ2EsUUFBbkIsQ0FBNEJQLElBQTVCLENBQWtDLFNBQVVRLFVBQVYsQ0FBc0JDLElBQXRCLENBQTRCLGlEQUN2RVgsV0FBVyxDQUFDWSxXQUFaLENBQXdCRixVQUFVLENBQUNHLEVBQW5DLEVBQ0tDLElBREwsQ0FDVSxTQUFVQyxJQUFWLENBQWdCLGlEQUN0QixHQUFJQSxJQUFKLENBQVUscURBQ04sTUFBT0osQ0FBQUEsSUFBSSxDQUFDLElBQUQsQ0FBTyxDQUNkRSxFQUFFLENBQUVFLElBQUksQ0FBQ0YsRUFESyxDQUVkRyxLQUFLLENBQUVELElBQUksQ0FBQ0MsS0FGRSxDQUFQLENBQVgsQ0FJSCxDQUxELGlDQURzQix5QkFPdEIsTUFBT0wsQ0FBQUEsSUFBSSxDQUFDLElBQUQsQ0FBTyxLQUFQLENBQVgsQ0FDSCxDQVRELEVBVUtNLEtBVkwsQ0FVVyxTQUFVQyxHQUFWLENBQWUsa0RBQ3RCQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSx5QkFBMkJGLEdBQXZDLEVBRHNCLHlCQUV0QlAsSUFBSSxDQUFDTyxHQUFELENBQU0sSUFBTixDQUFKLENBQ0gsQ0FiRCxFQWNILENBZlksQ0FBYixFQU5rQix5QkFzQmxCLE1BQU8sQ0FDSEcsVUFBVSxDQUFFLFVBQVksa0RBQUUsTUFBTzNCLENBQUFBLFFBQVEsQ0FBQzJCLFVBQVQsRUFBUCxDQUErQixDQUR0RCxDQUVIQyxZQUFZLENBQUUsVUFBWSxrREFBRSxNQUFPNUIsQ0FBQUEsUUFBUSxDQUFDNEIsWUFBVCxDQUFzQixLQUF0QixDQUE2QixDQUFFQyxPQUFPLENBQUUsS0FBWCxDQUE3QixDQUFQLENBQTBELENBRm5GLENBQVAsQ0FJSCxDLHlCQUNEL0IsT0FBTyxDQUFDUyxPQUFSLENBQWtCRixVQUFsQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBhc3Nwb3J0ID0gcmVxdWlyZShcInBhc3Nwb3J0XCIpO1xudmFyIHBhc3Nwb3J0X2p3dF8xID0gcmVxdWlyZShcInBhc3Nwb3J0LWp3dFwiKTtcbnZhciBzZXJ2aWNlXzEgPSByZXF1aXJlKFwiLi9tb2R1bGVzL3VzZXIvc2VydmljZVwiKTtcbnZhciBjb25maWcgPSByZXF1aXJlKFwiLi9jb25maWcvZW52L2NvbmZpZ1wiKSgpO1xuZnVuY3Rpb24gYXV0aENvbmZpZygpIHtcbiAgICB2YXIgVXNlclNlcnZpY2UgPSBuZXcgc2VydmljZV8xLmRlZmF1bHQoKTtcbiAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgc2VjcmV0T3JLZXk6IGNvbmZpZy5zZWNyZXQsXG4gICAgICAgIGp3dEZyb21SZXF1ZXN0OiBwYXNzcG9ydF9qd3RfMS5FeHRyYWN0Snd0LmZyb21BdXRoSGVhZGVyQXNCZWFyZXJUb2tlbigpLFxuICAgIH07XG4gICAgcGFzc3BvcnQudXNlKG5ldyBwYXNzcG9ydF9qd3RfMS5TdHJhdGVneShvcHRzLCBmdW5jdGlvbiAoand0UGF5bG9hZCwgZG9uZSkge1xuICAgICAgICBVc2VyU2VydmljZS5nZXRVc2VyQnlJZChqd3RQYXlsb2FkLmlkKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwge1xuICAgICAgICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZG9uZShudWxsLCBmYWxzZSk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBdXRoZW50aWNhdGlvbiBFcnJvcjogXCIgKyBlcnIpO1xuICAgICAgICAgICAgZG9uZShlcnIsIG51bGwpO1xuICAgICAgICB9KTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gcGFzc3BvcnQuaW5pdGlhbGl6ZSgpOyB9LFxuICAgICAgICBhdXRoZW50aWNhdGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhc3Nwb3J0LmF1dGhlbnRpY2F0ZShcImp3dFwiLCB7IHNlc3Npb246IGZhbHNlIH0pOyB9LFxuICAgIH07XG59XG5leHBvcnRzLmRlZmF1bHQgPSBhdXRoQ29uZmlnO1xuIl19